<!DOCTYPE html>
<html>
<head>
    <style>

.node rect {
  cursor: pointer;
  fill: #fff;
  fill-opacity: .5;
  stroke: #3182bd;
  stroke-width: 1.5px;
}

.node text {
  font: 10px sans-serif;
  pointer-events: none;
}

path.link {
  fill: none;
  stroke: #9ecae1;
  stroke-width: 1.5px;
}

</style>

  <title>Big Data Project 1</title>

  <!-- META/CSS Start -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!--<link rel="stylesheet" type="text/css" href="profile.css">-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- META/CSS End -->
</head>

<body style="background-color: #ddd;">

<header class="header">

<div class="container">

    <div class="row well" style="margin-top: 20px;">
        <div class="col-md-12">
            <h1 style="border-bottom: 1px solid dimgray;">Task 1</h1>
            <p id="task1Text" style="font-size: 1.8rem"></p>
            <small>(For some reason "Trump" appears really small comapred to the rest even thought it should be the largest word.)</small>
            <div id="graph1"></div>
        </div>
    </div>

    <div class="row well" style="margin-top: 20px;">
        <div class="col-md-12">
            <h1 style="border-bottom: 1px solid dimgray;">Task 2</h1>
            <p id="task2Text" style="font-size: 1.8rem">
                There was a problem parsing and massaging the data from Task 2 :C
            </p>
            <div id="graph2"></div>
        </div>
    </div>

    <div class="row well" style="margin-top: 20px;">
        <div class="col-md-12">
            <h1 style="border-bottom: 1px solid dimgray;">Task 3</h1>
            <p id="task3Text" style="font-size: 1.8rem"></p>
            <div id="graph3" style="height:800px; overflow: scroll;"></div>
        </div>
    </div>

    <div class="row well" style="margin-top: 20px;">
        <div class="col-md-12">
            <h1 style="border-bottom: 1px solid dimgray;">Task 4</h1>
            <p id="task4Text" style="font-size: 1.8rem"></p>
            <div id="graph4"></div>
        </div>
    </div>

    <div class="row well" style="margin-top: 20px;">
        <div class="col-md-12">
            <h1 style="border-bottom: 1px solid dimgray;">Task 5</h1>
            <p id="task5Text" style="font-size: 1.8rem"></p>
            <div id="graph5"></div>
        </div>
    </div>

    <div class="row well" style="margin-top: 20px;">
        <div class="col-md-12">
            <h1 style="border-bottom: 1px solid dimgray;">Task 6</h1>
            <p id="task6Text" style="font-size: 1.8rem"></p>
            <div id="graph6"></div>
        </div>
    </div>

</div>

<!-- Scripts Start -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="d3.js" charset="utf-8"></script>
<script src="d3.layout.cloud.js"></script>
<script src="d3.wordcloud.js"></script>
<script src="results/task1.js"></script>
<script src="results/task2.js"></script>
<script src="results/task3.js"></script>
<script src="results/task4.js"></script>
<script src="results/task5.js"></script>
<script src="results/task6.js"></script>

<script>
  $(function() {
    //Task 1 presentation
    var copiedObject = jQuery.extend(true, {}, task1Data);

    var text = "";
    var index = 0;
    
    task1Data.forEach(function(item){
        item.size = copiedObject[index].size;
        index++;
        text += item.text + ": " + item.size + ", ";
    });
    
    d3.wordcloud()
        .size([800, 800])
        .fill(d3.scale.ordinal().range(["#884400", "#448800", "#888800", "#444400"]))
        .selector('#graph1')
        .words(task1Data)
        .start();

    $('#task1Text').text(text);
    
    //Task 2 presentation
    d3.wordcloud()
        .size([800, 800])
        .fill(d3.scale.ordinal().range(["#884400", "#448800", "#888800", "#444400"]))
        .selector('#graph2')
        .words(task2Data)
        .start();
    text = "";
    task2Data.forEach(function(item){
        text += item.text + ": " + item.size + ", ";
    });
    $('#task2Text').text(text);

    //Task 3 presentation
    var colorIndex = 0;
    var colors = ["#b1c841", "#c85e45", "#acc5d1", "#bd5cc1", "#4e72bf", "#296667"];
    var circles = [];
    var x = 50;
    var y = 50;
    var bit = 0;
    var total = 0;
    task3Data.forEach(function(item){
        circles.push({text: item.username, x_axis: x, y_axis: y, radius: 50, color:colors[colorIndex]});
        if(x < 42520)
            x += 110;
        else {
            if(bit%2==0)
                x = 100;
            else
                x =50;
            y += 100;
            bit++;
        }
        colorIndex = (colorIndex+1)%6;
        total++;
    });
    $('#task3Text').text("Distinct Screen Names: " + totalData);
    var svg = d3.select("#graph3").append("svg")
    .attr("width", 42700)
    .attr("height", 21800);

    var elem = svg.selectAll("g myCircleText")
        .data(circles);

    var elemEnter = elem.enter()
	    .append("g")
        .attr("class", "node-group")
	    .attr("transform", function(d){return "translate("+d.x_axis+","+d.y_axis+")"});
    
    var circleInner = elemEnter.append("circle")
        .attr("class", "user-circle")
	    .attr("r", function(d){return d.radius} )
	    .attr("stroke", function(d) {return d.color;})
	    .attr("fill", function(d) {return d.color;});

    elemEnter.append("text")
	    .text(function(d){return d.text})
        .attr("class", "user-text")
    .attr({
      "text-anchor": "middle",
      "font-size": 13,
      "dy": 6
    });

    //Task 4 presentation
    var margin = {top: 30, right: 20, bottom: 30, left: 20},
    width = 960 - margin.left - margin.right,
    barHeight = 20,
    barWidth = width * .8;

var i = 0,
    duration = 400,
    root;

var tree = d3.layout.tree()
    .nodeSize([0, 20]);

var diagonal = d3.svg.diagonal()
    .projection(function(d) { return [d.y, d.x]; });

var svg = d3.select("#graph4").append("svg")
    .attr("width", width + margin.left + margin.right)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

jsonTest.x0 = 0;
  jsonTest.y0 = 0;
  update(root = jsonTest, "#graph4 > svg");


    //Task 5 presentation
var svg = d3.select("#graph5").append("svg")
    .attr("width", width + margin.left + margin.right)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

task5Data.x0 = 0;
  task5Data.y0 = 0;
  update(root = task5Data, "#graph5 > svg");

    //Task 6 presentation

    var svg = d3.select("#graph6").append("svg")
    .attr("width", width + margin.left + margin.right)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
task6Data.x0 = 0;
  task6Data.y0 = 0;
  update(root = task6Data, "#graph6 > svg");


function update(source, selector) {

  var nodes = tree.nodes(root);

  var height = Math.max(500, nodes.length * barHeight + margin.top + margin.bottom);

  d3.select(selector).transition()
      .duration(duration)
      .attr("height", height);

  d3.select(self.frameElement).transition()
      .duration(duration)
      .style("height", height + "px");

  // Compute the "layout".
  nodes.forEach(function(n, i) {
    n.x = i * barHeight;
  });

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .style("opacity", 1e-6);

  // Enter any new nodes at the parent's previous position.
  nodeEnter.append("rect")
      .attr("y", -barHeight / 2)
      .attr("height", barHeight)
      .attr("width", barWidth)
      .style("fill", color)
      .on("click", click);

  nodeEnter.append("text")
      .attr("dy", 3.5)
      .attr("dx", 5.5)
      .text(function(d) { return d.name; });

  // Transition nodes to their new position.
  nodeEnter.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; })
      .style("opacity", 1);

  node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; })
      .style("opacity", 1)
    .select("rect")
      .style("fill", color);

  // Transition exiting nodes to the parent's new position.
  node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .style("opacity", 1e-6)
      .remove();

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(tree.links(nodes), function(d) { return d.target.id; });

  // Enter any new links at the parent's previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      })
    .transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent's new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });
}

// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}

function color(d) {
  return d._children ? "#3182bd" : d.children ? "#c6dbef" : "#fd8d3c";
}

  });

</script>
<!-- Scripts End -->

</body>

</html>